<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>파일 업로드</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f9; /* Lighter shade for a cleaner look */
            padding: 40px; /* More padding for better spacing */
            text-align: center;
        }
        h2, h3 {
            color: #2c3e50; /* Darker shade for better contrast */
            margin-bottom: 30px;
        }
        form {
        background-color: #ffffff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* Updated shadow for more depth */
        width: 80%; /* Wider form on wide screens */
        max-width: 800px; /* Maximum width to maintain form usability */
        margin: 20px auto;
        text-align: left;
        }
        .form-group, .search-group, .review-group {
        margin-bottom: 10px;
        display: flex;
        align-items: center;
    }
    label {
        font-weight: bold;
        color: #495057;
        margin-right: 10px;
    }
    input[type="text"], input[type="file"] {
        flex-grow: 1; /* Allows input to fill available space */
        padding: 8px;
    }
    input.short-input {
        width: 150px; /* Explicitly set a narrow width for name inputs */
        margin-right: 10px; /* Space between input and button */
    }
    button[type="submit"] {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 8px 16px; /* Reduced padding */
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px; /* Smaller font size */
        margin-left: 10px; /* Adds space between input and button */
    }
    button[type="submit"]:hover {
        background-color: #0056b3;
    }
    ul.list-group {
        text-align: left;
        padding: 0;
        width: 80%;
        max-width: 800px;
        margin: 30px auto;
    }
    li.list-group-item {
        background-color: #e9ecef;
        padding: 10px;
        border: 1px solid #dee2e6;
        list-style-type: none;
        margin-top: 5px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 16px;
    }
    .ebook-title {
        flex-grow: 1; /* Allows the title to take up any extra space if needed */
        font-size: 20px; /* Larger font for ebook titles */
        font-weight: bold; /* Makes the font bold */
    }
    .search-group {
        display: flex; /* Align items horizontally */
        justify-content: space-between;
        margin-bottom: 10px;
    }
    .review-group {
        flex-shrink: 0; /* Prevents the review group from shrinking */
        margin-left: auto;  /* 오른쪽 정렬을 위해 왼쪽에 자동 마진을 추가 */
        flex-basis: 30%; /* 시작 크기를 전체 공간의 30%로 설정 */
        max-width: 300px; /* 최대 가로 크기를 300px로 제한 */
        min-width: 300px; /* 최소 가로 크기를 300px로 고정하여 일관된 크기 유지 */
    }
    .search-group input, .review-group input {
        flex-grow: 1; /* Input fields take up the available space */
        margin-right: 10px; /* Space between input and button */
    }
    .search-group button, .review-group button {
        white-space: nowrap; /* Prevent text wrapping on buttons */
    }
    .btn-success[disabled] {
        background-color: #2e7031; /* 어두운 녹색으로 변경 */
        border-color: #2e7031;
        opacity: 0.65; /* 버튼을 약간 흐리게 표시 */
        cursor: not-allowed; /* 마우스 오버 시 금지 아이콘 표시 */
    }

    .btn-success[disabled]:hover {
        background-color: #2e7031; /* 호버 상태에서도 색상 유지 */
        border-color: #2e7031;
    }
    .survey-links {
    text-align: center;
    margin-top: 20px;
    margin-bottom: 20px;
}

.survey-links button {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px 15px;
    margin: 5px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
}

.survey-links button:hover {
    background-color: #0056b3;
}

.survey-description {
    text-align: center;
    font-size: 14px;
    margin-top: 10px;
}

    </style>
      
</head>
<body>
    <div class="container">
        <h2>단어 목록과 전자책 업로드 및 분석</h2>
        <div class="survey-links">
            <p>설문 조사 링크:</p>
            <button onclick="window.location.href='http://ksurv.kr/akM3Nj09Ojw';">비문학</button>
            <button onclick="window.location.href='http://ksurv.kr/akM3Nj09Oj0';">문학</button>
        </div>
        <p class="survey-description">
            * 현재 분석하는 책이 <strong>문학 도서</strong>라면 '문학' 버튼 클릭하여 설문,
            <br>* 현재 분석하는 책이 <strong>비문학 도서</strong>라면 '비문학' 버튼 클릭하여 설문
        </p>
        <form action="/" method="post" enctype="multipart/form-data">
            <div class="form-group">
                <label for="username">사용자 이름:</label>
                <input type="text" id="username" name="username" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="ebook">전자책 PDF 파일:</label>
                <input type="file" name="ebook" id="ebook" class="form-control" required>
            </div>
            <button type="submit" class="btn btn-primary">분석 시작</button>
        </form>
        

        <h3>1차 검토 완료된 전자책 목록</h3>
        <form action="/" method="get" class="search-group">
            <input type="text" name="search" placeholder="책 제목을 입력하세요" class="form-control">
            <button type="submit" class="btn btn-info">검색</button>
        </form>
        <ul class="list-group">
            {% for book in reviewed_books %}
            <li class="list-group-item">
                <span class="ebook-title">{{ book.ebook_title|replace('.pdf', '') }}</span>
                <!-- Form to start second review -->
                {% if book.review_stage == 'first_review_complete' %}
                <form action="/start_second_review/{{ book.id }}" method="post" class="review-group">
                    <input type="text" name="reviewer_name" placeholder="이름을 입력하세요" required class="short-input">
                    <button type="submit" class="btn btn-sm btn-secondary">2차 검토 시작</button>
                </form>
                {% elif book.review_stage == 'second_review_started' %}
                <form action="/complete_second_review/{{ book.id }}" method="post" class="review-group">
                    <input type="text" name="reviewer_name" placeholder="이름을 입력하세요" required class="short-input">
                    <button type="submit" class="btn btn-sm btn-success">2차 검토 완료</button>
                </form>
                {% endif %}
                <!-- Form to compare results -->
                {% if book.review_stage == 'review_complete' %}
                <form action="/final_results/{{ book.id }}" method="post" class="review-group">
                    <button type="submit" class="btn btn-sm btn-success" disabled>최종 검토 완료</button>
                </form>
                {% endif %}
                {% if book.review_stage == 'second_review_complete' %}
                <form action="/start_third_review/{{ book.id }}" method="post" class="review-group">
                    <input type="text" name="reviewer_name" placeholder="이름을 입력하세요" required class="short-input">
                    <button type="submit" class="btn btn-sm btn-info">최종 검토 시작</button>
                </form>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script> 
</body>
</html>
