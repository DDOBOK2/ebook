<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>파일 업로드</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f4f9; /* Lighter shade for a cleaner look */
            padding: 40px; /* More padding for better spacing */
            text-align: center;
        }
        h2, h3 {
    font-size: 32px; /* 제목의 크기를 키웁니다 */
    color: #2c3e50; /* 진한 색상으로 눈에 잘 띄게 합니다 */
    font-weight: bold; /* 글꼴을 굵게 합니다 */
    text-align: center; /* 제목을 중앙 정렬합니다 */
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1); /* 약간의 그림자를 추가하여 입체감을 줍니다 */
}
        form {
        background-color: #ffffff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* Updated shadow for more depth */
        width: 80%; /* Wider form on wide screens */
        max-width: 800px; /* Maximum width to maintain form usability */
        margin: 20px auto;
        text-align: left;
        }
        .form-group, .search-group, .review-group {
        margin-bottom: 10px;
        display: flex;
        align-items: center;
    }
    .form-group button {
    margin: 0 auto; /* 자동으로 여백을 주어 가운데 정렬 */
    display: block; /* 블록 레벨 요소로 변경 */
}
    label {
        font-weight: bold;
        color: #495057;
        margin-right: 10px;
    }
    input[type="text"], input[type="file"] {
        flex-grow: 1; /* Allows input to fill available space */
        padding: 8px;
    }
    input.short-input {
        width: 150px; /* Explicitly set a narrow width for name inputs */
        margin-right: 10px; /* Space between input and button */
    }
    button[type="submit"] {
        background-color: #007bff;
        color: white;
        border: none;
        padding: 8px 16px; /* Reduced padding */
        border-radius: 5px;
        cursor: pointer;
        font-size: 14px; /* Smaller font size */
        margin-left: 10px; /* Adds space between input and button */
        text-align: center;
    }
    button[type="submit"]:hover {
        background-color: #0056b3;
    }
    ul.list-group {
        text-align: left;
        padding: 0;
        width: 80%;
        max-width: 800px;
        margin: 30px auto;
    }
    li.list-group-item {
        background-color: #e9ecef;
        padding: 10px;
        border: 1px solid #dee2e6;
        list-style-type: none;
        margin-top: 5px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 16px;
    }
    .ebook-title {
        flex-grow: 1; /* Allows the title to take up any extra space if needed */
        font-size: 20px; /* Larger font for ebook titles */
        font-weight: bold; /* Makes the font bold */
    }
    .search-group {
        display: flex; /* Align items horizontally */
        justify-content: space-between;
        margin-bottom: 10px;
    }
    .review-group {
        flex-shrink: 0; /* Prevents the review group from shrinking */
        margin-left: auto;  /* 오른쪽 정렬을 위해 왼쪽에 자동 마진을 추가 */
        flex-basis: 30%; /* 시작 크기를 전체 공간의 30%로 설정 */
        max-width: 300px; /* 최대 가로 크기를 300px로 제한 */
        min-width: 300px; /* 최소 가로 크기를 300px로 고정하여 일관된 크기 유지 */
    }
    .search-group input, .review-group input {
        flex-grow: 1; /* Input fields take up the available space */
        margin-right: 10px; /* Space between input and button */
    }
    .search-group button, .review-group button {
        white-space: nowrap; /* Prevent text wrapping on buttons */
    }
    .btn-success[disabled] {
        background-color: #2e7031; /* 어두운 녹색으로 변경 */
        border-color: #2e7031;
        opacity: 0.65; /* 버튼을 약간 흐리게 표시 */
        cursor: not-allowed; /* 마우스 오버 시 금지 아이콘 표시 */
    }

    .btn-success[disabled]:hover {
        background-color: #2e7031; /* 호버 상태에서도 색상 유지 */
        border-color: #2e7031;
    }
    .survey-links {
    text-align: left;
    margin-top: 20px;
    margin-bottom: 20px;
    font-weight: bold;
    color: #495057;
    margin-right: 10px;
    font-size: 24px;
}
.survey-buttons {
    text-align: center; /* 버튼을 가운데 정렬 */
}
.survey-links button {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 15px 30px; /* 버튼 크기 키우기 */
    margin: 10px 20px; /* 좌우 여백을 더 크게 조정 */
    border-radius: 10px; /* 둥근 모서리 */
    cursor: pointer;
    font-size: 18px; /* 폰트 크기 키우기 */
    text-align: center;
    display: inline-block; /* 버튼들을 인라인 블록으로 표시 */
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* 약간의 그림자 효과 */
    transition: background-color 0.3s ease, transform 0.3s ease; /* 호버 시 부드러운 전환 효과 */
}

.survey-links button:hover {
    background-color: #0056b3;
    transform: translateY(-2px); /* 호버 시 살짝 올라오는 효과 */
}

.survey-description {
    text-align: left;
    font-size: 16px;
    margin-top: 10px;
}
.description {
    color: rgb(153, 0, 0);
    text-align: left;
    font-size: 16px;
    margin-top: 10px;
}
.form-section {
            background-color: #ffffff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            width: 80%;
            max-width: 800px;
            margin: 20px auto;
            margin-bottom: 40px; /* 구분 간격 추가 */
            border-bottom: 2px solid #ccc; /* 구분선 추가 */
        }
        .btn-nonfiction {
    background-color: #3498db !important; /* 파란색 */
    color: white !important;
}

.btn-fiction {
    background-color: #2cbd00 !important; /* 초록색 */
    color: white !important;
}

.btn-nonfiction:hover, .btn-fiction:hover {
    background-color: #0056b3 !important; /* 호버 색상 변경 */
    opacity: 0.8 !important;
}

.btn-center {
    display: block !important;
    margin: 0 auto !important;
    width: fit-content !important;
}

    </style>
      
</head>
<body>
    <div class="container">
        <h2>사고도구어 수준별 분석(검증) 시스템</h2>
        <!-- First Box -->
        <div class="form-section">
            <div class="survey-links">
                <p class="description">
                    * 1차, 2차, 3차 분석 시작 전 설문을 먼저 진행해주세요.
                </p>
                <p>설문 조사 링크:</p>
                <div class="survey-buttons">
                    <button onclick="window.location.href='http://ksurv.kr/akM3Nj48Ozs';" class="btn-nonfiction">비문학</button>
                    <button onclick="window.location.href='http://ksurv.kr/akM3Nj48Ozw';" class="btn-fiction">문학</button>
                </div>
            </div>
            <p class="survey-description">
                * 현재 분석하는 책이 <strong>문학 도서</strong>라면 '문학' 버튼 클릭하여 설문,
                <br>* 현재 분석하는 책이 <strong>비문학 도서</strong>라면 '비문학' 버튼 클릭하여 설문
            </p>
        </div>

        <!-- Second Box -->
        <div class="form-section">
            <form id="uploadForm" action="/" method="post" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="username">검토 위원 이름:</label>
                    <input type="text" id="username" name="username" placeholder="이름을 입력하세요" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="ebook">전자책 PDF:</label>
                    <input type="file" name="ebook" id="ebook" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary btn-center">분석 시작</button>
            </form>
        </div>

        <div class="form-section">
        <h3>1차, 2차, 3차 분석(검증) 도서 목록</h3>
        <form action="/" method="get" class="search-group">
            <input type="text" name="search" placeholder="책 제목을 입력하세요" class="form-control">
            <button type="submit" class="btn btn-info">검색</button>
        </form>
        <ul class="list-group">
            {% for book in reviewed_books %}
            <li class="list-group-item">
                <span class="ebook-title">{{ book.ebook_title|replace('.pdf', '') }}</span>
                <!-- Form to start second review -->
                {% if book.review_stage == 'not_reviewed' %}
                <form action="{{ url_for('show_results') }}" method="get" class="review-group">
                    <input type="hidden" name="unique_id" value="{{ book.id }}">
                    <button type="submit" class="btn btn-sm btn-secondary">1차 검토 이어하기</button>
                </form>
                {% elif book.review_stage == 'first_review_complete' %}
                <form action="/start_second_review/{{ book.id }}" method="post" class="review-group">
                    <input type="text" name="reviewer_name" placeholder="이름을 입력하세요" required class="short-input">
                    <button type="submit" class="btn btn-sm btn-secondary">2차 검토 시작</button>
                </form>
                {% elif book.review_stage == 'second_review_started' %}
                <form action="{{ url_for('second_show_results') }}" method="get" class="review-group">
                    <input type="hidden" name="unique_id" value="{{ book.id }}">
                    <button type="submit" class="btn btn-sm btn-secondary">2차 검토 이어하기</button>
                </form>
                {% elif book.review_stage == 'second_review_complete' %}
                <form action="/start_third_review/{{ book.id }}" method="post" class="review-group">
                    <input type="text" name="reviewer_name" placeholder="이름을 입력하세요" required class="short-input">
                    <button type="submit" class="btn btn-sm btn-info">3차 검토 시작</button>
                </form>
                {% elif book.review_stage == 'third_review_started' %}
                <form action="{{ url_for('compare_results') }}" method="get" class="review-group">
                    <input type="hidden" name="unique_id" value="{{ book.id }}">
                    <button type="submit" class="btn btn-sm btn-info">3차 검토 이어하기</button>
                </form>               
                {% elif book.review_stage == 'review_complete' %}
                <form action="/final_results/{{ book.id }}" method="post" class="review-group">
                    <button type="submit" class="btn btn-sm btn-success" disabled>3차 검토 완료</button>
                </form>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
    </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 폼의 모든 input 요소에서 엔터 키 누름을 방지
            var form = document.getElementById('uploadForm');
            form.addEventListener('keydown', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    return false;
                }
            });
        });
    </script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script> 
</body>
</html>
